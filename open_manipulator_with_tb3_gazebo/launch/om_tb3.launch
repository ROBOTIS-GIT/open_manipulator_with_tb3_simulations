<?xml version="1.0"?>
<launch>
  <arg name="model" default="$(env TURTLEBOT3_MODEL)" doc="model type [waffle, waffle_pi]"/>

  <!-- Load the URDF into the ROS Parameter Server -->
  <param name="robot_description"
    command="$(find xacro)/xacro --inorder '$(find open_manipulator_with_tb3_description)/urdf/open_manipulator_with_tb3_$(arg model).urdf.xacro'"/>

  <node pkg="gazebo_ros" type="spawn_model" name="urdf_spawner" respawn="false" output="screen"
      args="-urdf -model robot -x 0.0 -y 0.0 -Y 0.0 -J joint1 0.0 -J joint2 -1.0 -J joint3 0.3 -J joint4 0.7 -J gripper 0.0 -J gripper_sub 0.0 -param robot_description"/>

  <include file="$(find open_manipulator_with_tb3_gazebo)/launch/controller_utils.launch"/>
  
  <!-- Start joint position controller -->
  <!-- <include file="$(find open_manipulator_with_tb3_gazebo)/launch/joint_position_controller.launch"/> -->

  <!-- Start gripper controller -->
  <rosparam file="$(find open_manipulator_with_tb3_gazebo)/config/arm_controller.yaml" command="load"/>
  <node name="arm_controller_spawner" pkg="controller_manager" type="controller_manager" respawn="false"
    output="screen" args="spawn arm_controller"/>

  <!-- Start gripper controller -->
  <rosparam file="$(find open_manipulator_with_tb3_gazebo)/config/gripper_controller.yaml" command="load"/>
  <node name="gripper_controller_spawner" pkg="controller_manager" type="controller_manager" respawn="false"
    output="screen" args="spawn gripper_controller"/>

</launch>
